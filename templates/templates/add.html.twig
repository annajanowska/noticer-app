{% extends 'index.html.twig' %}

{% block title %}Add{% endblock %}

{% block body %}

<div class="container">
	<div class="row">
		<div class="col-6 mx-auto my-5">
		<div class="card">
			<img class="card-img-top" src="Images/wallpaper.jpg">
			<div class="card-body">
				<h5 class="card-title ">Nowe ogłoszenie</h5>
				<form action="add.php" enctype="multipart/form-data" method="POST">
					<div class="d-flex flex-column">
						<div class="form-gruop row my-3 mx-3">
							<input class="add-photo" type="file" name="image" accept="image/jpeg,image/jpg">
						</div>
						<div class="form-gruop row my-2 mx-3">	
							<label>Dodaj tytuł</label>
							<input class="col-12 form-control" type="text" name="title" placeholder="Tytuł">
						</div>
						<div class="form-gruop row my-2 mx-3">	
							<label>Dodaj cenę</label>
							<input class="col-12 form-control" type="text" name="price" placeholder="Cena">
						</div>
						<div class="form-gruop row my-2 mx-3">	
							<label>Dodaj lokalizację</label>
							<input class="col-12 form-control" type="text" name="localization" placeholder="Lokalizacja">
						</div>
						<div class="form-gruop row my-2 mx-3">	
							<label>Wybierz kategorię </label>
							<select class="col-12 form-control" type="text" name="category" id= "slct1" placeholder="Kategoria" onchange="getSubcategory(this.id, 'slct2')">
								<option></option>
							 {% for name in categoriesNames %}
							 	<option value="{{name.categoryName}}">{{name.categoryName}}</option>
							 {% endfor %}
							</select>
							<script>
							function getSubcategory (s1, s2) 
							{
								var selectedValue = document.getElementById("slct1").value;
								console.log("Wybrana wartość to: ");
								console.log(selectedValue);
							
								var s1 = document.getElementById(s1);
								var s2 = document.getElementById(s2);
								console.log("To jest s1:" );
								console.log(s1);
								console.log("To jest s2: ");
								console.log(s2);						
								// fetchCategory(s1);
								$("#slct1");
								$.ajax({
									type:'post',
									url:'https://s401354.labagh.pl/ajaxRequestSubcategory.php',
									dataType: "json",
									data: {nameCat: selectedValue},
									//dataType : "text",
									/*success: function (data){
										$('#slct2').html(data);
									} */
									  success(data) {
										console.log(data);
										console.log("OTRZYMANE WARTOŚCI: ");
										console.log(data.subCategoryName[0]);
									},
									error(xhr, textStatus) {
										console.log("Wystąpił błąd z połączeniem:", textStatus);
									}
								/*.done(function( response ) {
        						console.log("Pobrano tekst: " + response);
   								 }) */
								/*.fail(function( xhr, status, errorThrown ) {
        						alert("Nie udalo sie pobrac danych.");
   								 }); */
								
								})
							}
							 /*function fetchCategory (slct) {
								$('#slct1').html('');
								$.ajax({
									type:'post',
									url:'add.php',
									data: { nameCat : slct},
									/*success: function (data){
										$('#slct2').html(data);
									} */
								/*})
							} */
							</script>
						</div>
						<div class="form-gruop row my-2 mx-3">	
							<label>Wybierz podkategorię (nieobowiązkowe)</label>
							<select class="col-12 form-control" type="text" id="slct2" name="subcategory" placeholder="Podkategoria">
 							 <!--<option>Opcja 1</option>
  							 <option>Opcja 2</option>
 							 <option>Opcja 3</option>-->
							</select>
						</div>
						<div class="form-gruop row my-2 mx-3">
							<label>Dodaj opis</label>
							<input class="col-12 form-control" type="text" name="description" placeholder="Opis">
						</div>
						<button type="submit" name="submit" class="btn btn-outline-primary mt-4 mx-3">Gotowe</button>
					</div>
				</form>
				<p class="row my-2 mx-3">{{test}}</p>
			</div>
		</div>
		</div>
	</div>
</div>



{% endblock %}